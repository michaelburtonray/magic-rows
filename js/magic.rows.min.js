/* Magic Rows | github.com/michaelburtonray/magic-rows */
;(function(a,b,c){"use strict";b.fn.magicRows=function(a){this.addClass("images");b("html").addClass("loading");this.css({"font-size":0,"text-align":"justify"}).children().css({display:"inline-block"}).find("img").css({display:"block"});var c=b("<style type='text/css'>.images:after { content: '.'; display: inline-block; width: 100%; }</style>");c.appendTo(b("head"));if(this.length>1){this.each(function(){b(this).magicRows(a)});return this}var d=[];var e=[];var f=b.extend({max_height:225,margin:6},a);this.init=function(){var a=b(this).find("img");a.each(function(){var a=b(this);var c={aspect_ratio:a.width()/a.height(),height:a.height(),index:a.parent().index(),width:a.width()};d.push(c)});this.trigger();b("html").removeClass("loading");return this};this.trigger=function(){var a=this.width();while(d.length>0){var c=d.shift();e.push(c);var g=0;for(var h=0;h<e.length;h++){g+=e[h].aspect_ratio}var i=f.margin*e.length*2-2*f.margin;var j=Math.floor((a-i)/g)-1;if(j<=f.max_height){for(var h=0;h<e.length;h++){var k=e[h].index;b(this).find("a:eq("+k+")").find("img")[0].style.height=j+"px";var l;if(h==0){l=f.margin+"px "+f.margin+"px "+f.margin+"px 0px"}else if(h==e.length-1){l=f.margin+"px 0 "+f.margin+"px "+f.margin+"px"}else{l=f.margin+"px"}b(this).find("a:eq("+k+")").find("img")[0].style.margin=l}e=[]}}if(e.length>0){for(var h=0;h<e.length;h++){var k=e[h].index;if(e.length>1)b(this).find("a:eq("+k+")").find("img")[0].style.height=j+"px";var l;if(h==0){l=f.margin+"px "+f.margin+"px "+f.margin+"px 0px"}else if(h==e.length-1){l=f.margin+"px 0 "+f.margin+"px "+f.margin+"px"}else{l=f.margin+"px"}b(this).find("a:eq("+k+")").find("img")[0].style.margin=l}}return this};return this.init()}})(window,jQuery);